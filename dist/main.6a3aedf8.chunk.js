(this.webpackJsonpconsultingbot=this.webpackJsonpconsultingbot||[]).push([[0],{125:function(e,t){},143:function(e,t){},145:function(e,t){},153:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(21),o=n.n(r),l=n(3),u=n(15),i=n(16),s=n.n(i),m=n(34),p=n(67),d=n.n(p),E=n(68),b=n.n(E),_=n(69),O=n.n(_),v=n(7),f=n(22),S=n.n(f),g=n(23),j=n(1),T="modeRow",C="modeModalHeader",M="modeModalSection",N="modeModalFooter",k="Write your nickname.",h="Write your email.",R="Camera",A="Voice",y="\uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 \ub2c9\ub124\uc784\uc785\ub2c8\ub2e4.",I="\ub2c9\ub124\uc784\uacfc \uc774\uba54\uc77c\uc744 \uc785\ub825\ud558\uc2dc\uace0, \uc0ac\uc6a9\uac00\ub2a5\ud55c\uc9c0 \ud655\uc778\ud574\uc8fc\uc138\uc694!",w="\uce74\uba54\ub77c, \ub9c8\uc774\ud06c \uc811\uadfc \uad8c\ud55c\uc744 \ud5c8\ub77d\ud574\uc8fc\uc138\uc694!",W="https://api.withpeer.site";var x=function(e){var t=e.onSubmit,n=Object(a.useState)({nickname:"",email:""}),r=Object(u.a)(n,2),o=r[0],l=r[1],i=o.nickname,s=o.email,m=function(e){var t=e.target,n=t.name,a=t.value;l(Object(j.a)(Object(j.a)({},o),{},Object(g.a)({},n,a)))};return c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(o)}},c.a.createElement("div",null,c.a.createElement("label",null,"Nickname"),c.a.createElement("input",{name:"nickname",placeholder:k,onChange:m,value:i})),c.a.createElement("div",null,c.a.createElement("label",null,"Email"),c.a.createElement("input",{name:"email",placeholder:h,onChange:m,value:s})),c.a.createElement("button",{type:"submit"},"Check"))};function U(e){return{type:"CONNECT_CUSTOMER_STREAM",customerStream:e}}function G(e){return{type:"GET_PEER",peer:e}}function K(e){return{type:"GET_CUSTOMER_NAME",nickname:e}}function L(e){return{type:"GET_CUSTOMER_MODE",mode:e}}function P(e){return{type:"SET_REQUEST",isRequest:e}}var q=n(2),F=n.n(q),z=S.a.bind(F.a);var B=function(e){var t=e.onToggleSelectMode,n=e.onToggleConsulting,a=Object(l.b)(),r=Object(l.c)((function(e){return e.customer.nickname})),o=Object(l.c)((function(e){return e.customer.isRequest})),u=localStorage.getItem("consultantId"),i=!0,p=function(){var e=Object(m.a)(s.a.mark((function e(c){var l,m,p,d,E;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=2;break}return e.abrupt("return",alert(I));case 2:return l=c.currentTarget.value,m="Voice"===l,e.prev=4,e.next=7,navigator.mediaDevices.getUserMedia({video:!m,audio:!0});case 7:p=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),alert(w);case 13:d=new O.a({initiator:!0,trickle:!1,stream:p}),E=b()(W),d.on("signal",(function(e){i&&E.emit("joinCustomer",{nickname:r,mode:l,consultant:u,signal:e},(function(e){alert(e),i=!1}))})),d.on("stream",(function(e){a({type:"CONNECT_CONSULTANT_STREAM",consultantStream:e})})),E.on("acceptConsultant",(function(e){d.signal(e)})),t(),n(),a({type:"CONNECT_SOCKET",socket:E}),a(U(p)),a(G(d)),a(L(l));case 24:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(m.a)(s.a.mark((function e(t){var n,c,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.nickname,c=t.email,r={nickname:n,email:c,consultant:u},e.next=5,d()({method:"post",url:"".concat(W,"/api/customers"),headers:{"Content-Type":"application/json"},data:r});case 5:return a(K(n)),a(P(!0)),e.abrupt("return",alert(y));case 10:e.prev=10,e.t0=e.catch(0),e.t0.response&&alert(e.t0.response.data.errMessage);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();return c.a.createElement("div",{className:F.a.modeSelectWrapper},c.a.createElement("button",{onClick:t,className:F.a.closeButton},c.a.createElement(v.c,{size:20,color:"white"})),c.a.createElement("header",{className:z(T,C)},c.a.createElement("div",null,"\uc0c1\ub2f4 \ud488\uc9c8 \ud5a5\uc0c1\uc744 \uc704\ud574,"),c.a.createElement("div",null,"\ubaa8\ub4e0 \uc0c1\ub2f4\uc740 \ub179\uc74c\ub429\ub2c8\ub2e4.")),c.a.createElement("section",{className:z(T,M)},c.a.createElement(x,{onSubmit:E})),c.a.createElement("footer",{className:z(T,N)},c.a.createElement("div",null,c.a.createElement(v.b,null),c.a.createElement("button",{onClick:p,value:R},R)),c.a.createElement("div",null,c.a.createElement(v.a,null),c.a.createElement("button",{onClick:p,value:A},A))))},D=S.a.bind(F.a);var H=function(e){var t=e.onToggleConsulting,n=Object(l.b)(),r=Object(l.c)((function(e){return e.socket.socket})),o=Object(l.c)((function(e){return e.customer.nickname})),u=Object(l.c)((function(e){return e.customer.mode})),i=Object(l.c)((function(e){return e.stream.customerStream})),s=Object(l.c)((function(e){return e.stream.consultantStream})),m=Object(l.c)((function(e){return e.stream.peer})),p=localStorage.getItem("consultantName"),d="Voice"===u,E=Object(a.useRef)(null),b=Object(a.useRef)(null);return Object(a.useEffect)((function(){E.current&&(E.current.srcObject=s)}),[s]),Object(a.useEffect)((function(){b.current&&(b.current.srcObject=i)}),[i]),Object(a.useEffect)((function(){return function(){r&&r.disconnect()}}),[]),c.a.createElement("div",{className:F.a.consultingWrapper},c.a.createElement("button",{onClick:function(){t();var e=localStorage.getItem("consultantId");r.emit("leaveCustomer",o,e,(function(e){alert(e),r.disconnect(),m&&m.destroy(),n({type:"INITIAL_CUSTOMER"}),n({type:"INITAIL_STREAM_PEER"}),n({type:"INITAIL_SOCKET"}),n(P(!1))}))},className:F.a.consultingClose},c.a.createElement(v.c,{size:20,color:"white"})),c.a.createElement("section",{className:F.a.screenWrapper},c.a.createElement("div",{className:F.a.text},"".concat(p,"\ub2d8")),c.a.createElement("div",{className:F.a.videoWrapper},d&&c.a.createElement(v.a,{size:150,color:"rgb(79, 91, 255)"}),c.a.createElement("video",{playsInline:!0,autoPlay:!0,ref:E,className:D({voiceMode:d,cameraMode:!d})})),c.a.createElement("div",{className:F.a.text},"".concat(o,"\ub2d8")),c.a.createElement("div",{className:F.a.videoWrapper},d&&c.a.createElement(v.a,{size:150,color:"rgb(79, 91, 255)"}),c.a.createElement("video",{playsInline:!0,autoPlay:!0,muted:!0,ref:b,className:D({voiceMode:d,cameraMode:!d})}))))};var V=function(e){var t=e.onClick;return c.a.createElement("button",{onClick:t,className:F.a.chatbot},c.a.createElement("img",{src:"https://img.icons8.com/nolan/96/chat.png",alt:"chatBot"}))};var J=function(){var e=Object(a.useState)(!0),t=Object(u.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)(!0),l=Object(u.a)(o,2),i=l[0],s=l[1],m=function(){return r(!n)},p=function(){return s(!i)};return c.a.createElement(a.Fragment,null,!i&&c.a.createElement(H,{onToggleConsulting:p}),!n&&c.a.createElement(B,{onToggleSelectMode:m,onToggleConsulting:p}),c.a.createElement(V,{onClick:m}))},Q=n(9),X=(n(152),{socket:null});var Y={nickname:"",mode:"",isRequest:!1};var Z={customerStream:null,consultantStream:null,peer:null};var $=Object(Q.c)({socket:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CONNECT_SOCKET":return Object(j.a)(Object(j.a)({},e),{},{socket:t.socket});case"INITAIL_SOCKET":return Object(j.a)(Object(j.a)({},e),{},{socket:null});default:return e}},customer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_CUSTOMER_NAME":return Object(j.a)(Object(j.a)({},e),{},{nickname:t.nickname});case"GET_CUSTOMER_MODE":return Object(j.a)(Object(j.a)({},e),{},{mode:t.mode});case"INITIAL_CUSTOMER":return Object(j.a)(Object(j.a)({},e),{},{nickname:"",mode:""});case"SET_REQUEST":return Object(j.a)(Object(j.a)({},e),{},{isRequest:t.isRequest});default:return e}},stream:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CONNECT_CUSTOMER_STREAM":return Object(j.a)(Object(j.a)({},e),{},{customerStream:t.customerStream});case"CONNECT_CONSULTANT_STREAM":return Object(j.a)(Object(j.a)({},e),{},{consultantStream:t.consultantStream});case"GET_PEER":return Object(j.a)(Object(j.a)({},e),{},{peer:t.peer});case"INITAIL_STREAM_PEER":return Object(j.a)(Object(j.a)({},e),{},{customerStream:null,consultantStream:null,peer:null});default:return e}}});var ee=Object(Q.d)($,Q.a.apply(void 0,[]));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(l.a,{store:ee},c.a.createElement(J,null))),document.getElementById("peer-root"))},2:function(e,t,n){e.exports={chatbot:"App_chatbot__3K986",consultingWrapper:"App_consultingWrapper__13GKR",modeSelectWrapper:"App_modeSelectWrapper__3ixIn",screenWrapper:"App_screenWrapper__2K3e_",videoWrapper:"App_videoWrapper__3Scof",consultingClose:"App_consultingClose__qFtzx",voiceMode:"App_voiceMode__5iPnZ",cameraMode:"App_cameraMode__31KX4",text:"App_text__r7O9V",ready:"App_ready__iuMDc",closeButton:"App_closeButton__1ee0W",modeRow:"App_modeRow__n58wG",modeModalHeader:"App_modeModalHeader__3oYRa",modeModalSection:"App_modeModalSection__1JFRU",modeModalFooter:"App_modeModalFooter__2h6HG"}},70:function(e,t,n){e.exports=n(153)}},[[70,1,2]]]);
//# sourceMappingURL=main.6a3aedf8.chunk.js.map