(this.webpackJsonpconsultingbot=this.webpackJsonpconsultingbot||[]).push([[0],{124:function(e,t){},140:function(e,t){},142:function(e,t){},151:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(19),o=n.n(c),l=n(3),u=n(16),i=n(11),s=n.n(i),m=n(22),p=n(65),d=n.n(p),E=n(66),_=n.n(E),v=n(67),b=n.n(v),f=n(8),O=n(20),S=n.n(O),g=n(21),T=n(1),C="modeRow",h="modeModalHeader",j="modeModalSection",k="modeModalFooter",M="Write your nickname.",N="Write your email.",R="Camera",A="Voice",y="\uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 \ub2c9\ub124\uc784\uc785\ub2c8\ub2e4.",I="\ub2c9\ub124\uc784\uacfc \uc774\uba54\uc77c\uc744 \uc785\ub825\ud558\uc2dc\uace0, \uc0ac\uc6a9\uac00\ub2a5\ud55c\uc9c0 \ud655\uc778\ud574\uc8fc\uc138\uc694!",w="\uce74\uba54\ub77c, \ub9c8\uc774\ud06c \uc811\uadfc \uad8c\ud55c\uc744 \ud5c8\ub77d\ud574\uc8fc\uc138\uc694!";var x=function(e){var t=e.onSubmit,n=Object(a.useState)({nickname:"",email:""}),c=Object(u.a)(n,2),o=c[0],l=c[1],i=o.nickname,s=o.email,m=function(e){var t=e.target,n=t.name,a=t.value;l(Object(T.a)({},o,Object(g.a)({},n,a)))};return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(o)}},r.a.createElement("div",null,r.a.createElement("label",null,"Nickname"),r.a.createElement("input",{name:"nickname",placeholder:M,onChange:m,value:i})),r.a.createElement("div",null,r.a.createElement("label",null,"Email"),r.a.createElement("input",{name:"email",placeholder:N,onChange:m,value:s})),r.a.createElement("button",{type:"submit"},"Check"))};function W(e){return{type:"CONNECT_CUSTOMER_STREAM",customerStream:e}}function U(e){return{type:"GET_PEER",peer:e}}function G(e){return{type:"GET_CUSTOMER_NAME",nickname:e}}function K(e){return{type:"GET_CUSTOMER_MODE",mode:e}}function L(e){return{type:"SET_REQUEST",isRequest:e}}var P=n(2),q=n.n(P),F=S.a.bind(q.a);var z=function(e){var t=e.onToggleSelectMode,n=e.onToggleConsulting,a=Object(l.b)(),c=Object(l.c)((function(e){return e.customer.nickname})),o=Object(l.c)((function(e){return e.customer.isRequest})),u=localStorage.getItem("consultantId"),i=!0,p=function(){var e=Object(m.a)(s.a.mark((function e(r){var l,m,p,d,E;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=2;break}return e.abrupt("return",alert(I));case 2:return l=r.currentTarget.value,m="Voice"===l,e.prev=4,e.next=7,navigator.mediaDevices.getUserMedia({video:!m,audio:!0});case 7:p=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),alert(w);case 13:d=new b.a({initiator:!0,trickle:!1,stream:p}),E=_()("http://localhost:5000"),d.on("signal",(function(e){i&&E.emit("joinCustomer",{nickname:c,mode:l,consultant:u,signal:e},(function(e){alert(e),i=!1}))})),d.on("stream",(function(e){a({type:"CONNECT_CONSULTANT_STREAM",consultantStream:e})})),E.on("acceptConsultant",(function(e){d.signal(e)})),t(),n(),a({type:"CONNECT_SOCKET",socket:E}),a(W(p)),a(U(d)),a(K(l));case 24:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(m.a)(s.a.mark((function e(t){var n,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.nickname,r=t.email,c={nickname:n,email:r,consultant:u},e.prev=2,e.next=5,d()({method:"post",url:"".concat("http://localhost:5000/api/customers"),headers:{"Content-Type":"application/json"},data:c}).then(function(){var e=Object(m.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("ok"!==t.data.result){e.next=5;break}return a(G(n)),a(L(!0)),e.abrupt("return",alert(y));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:return e.abrupt("return",e.sent);case 8:e.prev=8,e.t0=e.catch(2),alert(e.t0.response.data.errMessage);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:q.a.modeSelectWrapper},r.a.createElement("button",{onClick:t,className:q.a.closeButton},r.a.createElement(f.c,{size:20,color:"white"})),r.a.createElement("header",{className:F(C,h)},r.a.createElement("div",null,"\uc0c1\ub2f4 \ud488\uc9c8 \ud5a5\uc0c1\uc744 \uc704\ud574,"),r.a.createElement("div",null,"\ubaa8\ub4e0 \uc0c1\ub2f4\uc740 \ub179\uc74c(\ub179\ud654)\ub429\ub2c8\ub2e4.")),r.a.createElement("section",{className:F(C,j)},r.a.createElement(x,{onSubmit:E})),r.a.createElement("footer",{className:F(C,k)},r.a.createElement("div",null,r.a.createElement(f.b,null),r.a.createElement("button",{onClick:p,value:R},R)),r.a.createElement("div",null,r.a.createElement(f.a,null),r.a.createElement("button",{onClick:p,value:A},A))))},B=S.a.bind(q.a);var D=function(e){var t=e.onToggleConsulting,n=Object(l.b)(),c=Object(l.c)((function(e){return e.socket.socket})),o=Object(l.c)((function(e){return e.customer.nickname})),u=Object(l.c)((function(e){return e.customer.mode})),i=Object(l.c)((function(e){return e.stream.customerStream})),s=Object(l.c)((function(e){return e.stream.consultantStream})),m=Object(l.c)((function(e){return e.stream.peer})),p=localStorage.getItem("consultantName"),d="Voice"===u,E=Object(a.useRef)(null),_=Object(a.useRef)(null);return Object(a.useEffect)((function(){E.current&&(E.current.srcObject=s)}),[s]),Object(a.useEffect)((function(){_.current&&(_.current.srcObject=i)}),[i]),r.a.createElement("div",{className:q.a.consultingWrapper},r.a.createElement("button",{onClick:function(){t();var e=localStorage.getItem("consultantId");c.emit("leaveCustomer",o,e,(function(e){alert(e),c.disconnect(),m&&m.destroy(),n({type:"INITIAL_CUSTOMER"}),n({type:"INITAIL_STREAM_PEER"}),n({type:"INITAIL_SOCKET"}),n(L(!1))}))},className:q.a.consultingClose},r.a.createElement(f.c,{size:20,color:"white"})),r.a.createElement("section",{className:q.a.screenWrapper},r.a.createElement("div",{className:q.a.text},"".concat(p,"\ub2d8")),r.a.createElement("div",{className:q.a.videoWrapper},d&&r.a.createElement(f.a,{size:150,color:"rgb(79, 91, 255)"}),r.a.createElement("video",{playsInline:!0,autoPlay:!0,ref:E,className:B({voiceMode:d,cameraMode:!d})})),r.a.createElement("div",{className:q.a.text},"".concat(o,"\ub2d8")),r.a.createElement("div",{className:q.a.videoWrapper},d&&r.a.createElement(f.a,{size:150,color:"rgb(79, 91, 255)"}),r.a.createElement("video",{playsInline:!0,autoPlay:!0,ref:_,className:B({voiceMode:d,cameraMode:!d})}))))};var H=function(e){var t=e.onClick;return r.a.createElement("button",{onClick:t,className:q.a.chatbot},r.a.createElement("img",{src:"https://img.icons8.com/nolan/96/chat.png",alt:"chatBot"}))};var V=function(){var e=Object(a.useState)(!0),t=Object(u.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(!0),l=Object(u.a)(o,2),i=l[0],s=l[1],m=function(){return c(!n)},p=function(){return s(!i)};return r.a.createElement(a.Fragment,null,!i&&r.a.createElement(D,{onToggleConsulting:p}),!n&&r.a.createElement(z,{onToggleSelectMode:m,onToggleConsulting:p}),r.a.createElement(H,{onClick:m}))},J=n(10),Q=(n(150),{socket:null});var X={nickname:"",mode:"",isRequest:!1};var Y={customerStream:null,consultantStream:null,peer:null};var Z=Object(J.c)({socket:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CONNECT_SOCKET":return Object(T.a)({},e,{socket:t.socket});case"INITAIL_SOCKET":return Object(T.a)({},e,{socket:null});default:return e}},customer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_CUSTOMER_NAME":return Object(T.a)({},e,{nickname:t.nickname});case"GET_CUSTOMER_MODE":return Object(T.a)({},e,{mode:t.mode});case"INITIAL_CUSTOMER":return Object(T.a)({},e,{nickname:"",mode:""});case"SET_REQUEST":return Object(T.a)({},e,{isRequest:t.isRequest});default:return e}},stream:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CONNECT_CUSTOMER_STREAM":return Object(T.a)({},e,{customerStream:t.customerStream});case"CONNECT_CONSULTANT_STREAM":return Object(T.a)({},e,{consultantStream:t.consultantStream});case"GET_PEER":return Object(T.a)({},e,{peer:t.peer});case"INITAIL_STREAM_PEER":return Object(T.a)({},e,{customerStream:null,consultantStream:null,peer:null});default:return e}}});var $=Object(J.d)(Z,J.a.apply(void 0,[]));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(l.a,{store:$},r.a.createElement(V,null))),document.getElementById("peer-root"))},2:function(e,t,n){e.exports={consultingWrapper:"App_consultingWrapper__13GKR",screenWrapper:"App_screenWrapper__2K3e_",videoWrapper:"App_videoWrapper__3Scof",consultingClose:"App_consultingClose__qFtzx",voiceMode:"App_voiceMode__5iPnZ",cameraMode:"App_cameraMode__31KX4",text:"App_text__r7O9V",ready:"App_ready__iuMDc",modeSelectWrapper:"App_modeSelectWrapper__3ixIn",closeButton:"App_closeButton__1ee0W",modeRow:"App_modeRow__n58wG",modeModalHeader:"App_modeModalHeader__3oYRa",modeModalSection:"App_modeModalSection__1JFRU",modeModalFooter:"App_modeModalFooter__2h6HG",chatbot:"App_chatbot__3K986"}},68:function(e,t,n){e.exports=n(151)}},[[68,1,2]]]);
//# sourceMappingURL=main.87c6da9f.chunk.js.map